<!DOCTYPE html><html lang='ru'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Система блочной сортировки</title><link rel='stylesheet' href='style.css'></head><body><div class='container'><header><h1>Система блочной сортировки</h1></header><div class='auth-box' id='auth-box'><h3>Регистрация / Вход</h3><input id='username' placeholder='Имя пользователя'><input id='password' type='password' placeholder='Пароль'><button class='btn-primary' onclick='register()'>Регистрация</button><button class='btn-success' onclick='login()'>Вход</button></div><div id='user-info'></div><div id='main-content' style='display:none'><h3>Работа с массивом</h3><input id='manual-input' placeholder='Введите числа через запятую'><button class='btn-primary' onclick='applyManual()'>Применить</button><button class='btn-warning' onclick='autoFill()'>Автозаполнение</button><button class='btn-success' onclick='saveToSQL()'>Сохранить в SQL Server</button><button class='btn-danger' onclick='logout()'>Выход</button><div class='array-box'><strong>Текущий массив:</strong> <span id='current-array'>43,49,63,65,70,75,88,90,93,96</span></div><div class='array-box'><strong>Отсортированный массив:</strong> <span id='sorted-array'>43,49,63,65,70,75,88,90,93,96</span></div></div></div><div class='toast' id='toast'></div><script>function toast(msg, type='info'){let t=document.getElementById('toast');t.textContent=msg;t.className='toast show';setTimeout(()=>t.classList.remove('show'),3000)}function sortArray(arr){return arr.slice().sort((a,b)=>a-b)}function updateDisplay(arr){document.getElementById('current-array').textContent=arr.join(',');document.getElementById('sorted-array').textContent=sortArray(arr).join(',');return arr}function applyManual(){let val=document.getElementById('manual-input').value;if(!val)return;let arr=val.split(',').map(x=>parseInt(x.trim())).filter(x=>!isNaN(x));if(arr.length>0){updateDisplay(arr);toast('Массив обновлен')}else toast('Некорректный ввод','error')}function autoFill(){let arr=[];for(let i=0;i<10;i++)arr.push(Math.floor(Math.random()*100));updateDisplay(arr);toast('Сгенерирован случайный массив')}function register(){let user=document.getElementById('username').value;let pass=document.getElementById('password').value;if(!user||!pass){toast('Заполните все поля','error');return}fetch('/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:user,password:pass})}).then(r=>r.json()).then(data=>{if(data.status==='success'){document.getElementById('user-info').innerHTML='Пользователь: '+data.username;document.getElementById('auth-box').style.display='none';document.getElementById('main-content').style.display='block';toast('Регистрация успешна!','success');checkUser();}else toast(data.message,'error')})}function login(){let user=document.getElementById('username').value;let pass=document.getElementById('password').value;if(!user||!pass){toast('Заполните все поля','error');return}fetch('/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:user,password:pass})}).then(r=>r.json()).then(data=>{if(data.status==='success'){document.getElementById('user-info').innerHTML='Пользователь: '+data.username;document.getElementById('auth-box').style.display='none';document.getElementById('main-content').style.display='block';toast('Вход выполнен','success');checkUser();}else toast(data.message,'error')})}function logout(){fetch('/logout',{method:'POST'}).then(()=>{document.getElementById('auth-box').style.display='block';document.getElementById('main-content').style.display='none';document.getElementById('user-info').innerHTML='';toast('Вы вышли из системы')})}function saveToSQL(){let arrText=document.getElementById('sorted-array').textContent;fetch('/save',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({array:arrText})}).then(r=>r.json()).then(data=>{if(data.status==='success')toast(''+data.message,'success');else toast(''+data.message,'error')}).catch(()=>toast('Ошибка соединения','error'))}function checkUser(){fetch('/current-user').then(r=>r.json()).then(data=>{if(data.status==='success'){document.getElementById('user-info').innerHTML='Пользователь: '+data.username;document.getElementById('auth-box').style.display='none';document.getElementById('main-content').style.display='block';}})}// Проверяем при загрузкеwindow.onload=checkUser;</script></body></html>